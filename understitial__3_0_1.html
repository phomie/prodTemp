<html>

<head>
    <script>
        var frameElem = frameElement;

        var frameContainer = frameElem.parentElement;

        var inwidth = frameElem.clientWidth

        var frameContainer1 = window.top.document.body
        thsize = frameContainer1.offsetWidth
        var contenttyp = window.parent.atf.getContentType();

        var basehosttry = window.location.hostname.split(".")[0];
        if (basehosttry == "www" || basehosttry == "dev") {
            basehost = window.location.hostname.split(".")[1]

        } else {
            basehost = window.location.hostname.split(".")[0]

        }
        var creativeType = "understitial";
        if (basehost.includes("-")) {
            basehost2 = basehost.split("-")
            basehost3 = basehost2.join("")
            dataToRetrieve = basehost3
        } else {
            dataToRetrieve = basehost
        }

        var obj = window.parent.creativeSettings;

        var creativetypte = creativeType;

        function GetPropertyValue(obj, dataToRetrieve, contenttyp, creativetypte) {
            return obj[dataToRetrieve][contenttyp][creativetypte];
        }
        understitialobj = GetPropertyValue(obj, dataToRetrieve, contenttyp, creativetypte);

        var env = '[%ENVIRONMENT%]';
        if (env == "desktop") {
            console.log('env=desktop');
            formatWidth = understitialobj.whichcase[0].desktop[0].contwidth;
            formatHeight = understitialobj.whichcase[0].desktop[0].contheight;
            bottomobj = understitialobj.whichcase[0].desktop[0].bottom;
            if (basehosttry == "focusbusiness" || basehost == "focus-tierarzt" || basehost == "focus-anwalt" ||
                basehost == "focus-steuerberater" || basehost == "focus-mobility") {
                sitewidth = frameElem.closest('.ad-wrapper').offsetWidth

            } else if (basehost == "instyle" || basehost == "elle" || basehost == "esquire" || basehost == "freundin" ||
                basehost == "harpersbazaar") {
                theslot = frameContainer.parentElement.parentElement

                if (theslot.getAttribute("atf-contenttype") == "article") {
                    sitewidth = understitialobj.whichcase[0].desktop[0].left

                } else {
                    sitewidth = frameContainer.offsetWidth
                }



            } else {
                sitewidth = understitialobj.whichcase[0].desktop[0].left

            }
            frambot = understitialobj.whichcase[0].desktop[0].frambot;
        } else if (env == "mobile") {
            console.log('env=mobile');
            formatWidth = understitialobj.whichcase[0].mobile[0].contwidth;

            formatHeight = understitialobj.whichcase[0].mobile[0].contheight;
            bottomobj = understitialobj.whichcase[0].mobile[0].bottom;
            if (basehosttry == "focusbusiness" || basehost == "focus-tierarzt" || basehost == "focus-anwalt" ||
                basehost == "focus-steuerberater" || basehost == "focus-mobility") {
                sitewidth = frameElem.closest('.ad-wrapper').offsetWidth

            } else {
                sitewidth = thsize


            }
            frambot = understitialobj.whichcase[0].mobile[0].frambot; //600
        }



        var atfadvertisementmessage = document.createElement("div");

        //if (basehost == "instyle" || basehost == "elle" || basehost == "esquire" || basehost == "freundin" || basehost == "harpersbazaar") {
        atfadvertisementmessage.setAttribute("style",
            "background: rgb(0, 0, 0); color: rgb(255, 255, 255); position: absolute; z-index: 4; top: 0px; left: 0px; right: 0px; width:100%; margin: 0px; padding: 5px; text-align: center; text-transform: uppercase; font: 10px / 10px Helvetica, Arial, sans-serif; box-shadow: black 0px 1px 10px;"
        );
        atfadvertisementmessage.setAttribute("id","advertisementContainer")
        var adtext = document.createTextNode("ADVERTISEMENT");
        atfadvertisementmessage.appendChild(adtext);
        frameContainer.appendChild(atfadvertisementmessage);
        var atfadvertisementmessage1 = document.createElement("div");
        atfadvertisementmessage1.setAttribute("style",
            "background: rgb(0, 0, 0); color: rgb(255, 255, 255); position: absolute; z-index: 3; bottom:" +
            bottomobj +
            "px; left: 0px; right: 0px; width: 100%; margin: 0px; padding: 5px; text-align: center; text-transform: uppercase; font: 10px / 10px Helvetica, Arial, sans-serif; box-shadow: black 0px -1px 10px;"
        );
        var adtext1 = document.createTextNode("Scroll to continue with content");
        atfadvertisementmessage1.appendChild(adtext1);
        frameContainer.appendChild(atfadvertisementmessage1);


        var frameContainerParent = frameContainer.parentElement;
        var frameContainerParentParent = frameContainer.parentElement.parentElement.parentElement;
        thedivtoadjust = frameContainerParent.firstChild;
        thedivtoadjust.style.height = formatHeight + 'px !important';
        thedivtoadjust.style.backgroundColor = "[%Background_Color%]";
        frameContainerParentParent.style.position = 'relative';
        frameContainerParentParent.style.height = formatHeight + 'px';
        var parentWin = parent.window;
        var bottomPosition = 0;
        var frameCorrectedLeft = false;
        var frameContainerParentBCRTop, frameElemBCRTop, topPosition, footers, siteHeader;
        frameElem.style.margin = '0';
        frameElem.style.padding = '0';
        frameElem.style.border = 'none';
        frameElem.style.position = 'fixed';
        frameElem.width = formatWidth + 'px';
        frameElem.height = formatHeight + 'px';
        frameContainer.style.position = 'absolute';
        frameContainer.style.clip = 'rect(auto, auto, auto, auto)';
        frameContainer.style.width = '100%';
        frameContainer.style.margin = '0 auto';
        frameContainer.style.height = formatHeight + 'px';
        frameContainer.style.width = '100%';
        frameContainerParent.style.position = 'relative';
        frameContainerParent.style.height = formatHeight + 'px';
        parentWin.onscroll = function () {
            scrollHandling();
        };
        parentWin.onresize = function () {
            scrollHandling();
        };

        function scrollHandling() {
            theresult = sitewidth - formatWidth;

            frameContainerParentBCRTop = frameContainerParent.getBoundingClientRect().top;
            frameElemBCRTop = frameElem.getBoundingClientRect().top;
            footers = parent.document.querySelectorAll('footer');
            if (typeof footers != 'undefined' && footers !== null) {
                if (footers.length > 0) {
                    for (var footerCnt = 0; footerCnt < footers.length; footerCnt++) {
                        computedStyles = parentWin.getComputedStyle(footers[footerCnt]);
                        if (computedStyles.getPropertyValue('position') === 'fixed') {
                            bottomPosition = footers[footerCnt].offsetHeight;

                        }
                    }
                }
            }
            frameElem.style.bottom = bottomPosition + 'px';


            if (frameContainerParentBCRTop <= frameElemBCRTop && frameContainerParentBCRTop <= topPosition &&
                frameContainerParentBCRTop <= (parentWin.innerHeight - frameContainerParent.offsetHeight -
                    bottomPosition)) {

                frameElem.style.position = 'fixed';
                frameElem.style.bottom = (((window.top.innerHeight) - frambot) / 2) + 5 + "px";
                tofind= parent.document.querySelector("#advertisementContainer")  
                theposplus = ((tofind.getBoundingClientRect().width) - formatWidth) / 2
                frameElem.style.left = tofind.getBoundingClientRect().left + theposplus + "px";
               
            } else if (frameContainerParentBCRTop <= (parentWin.innerHeight - frameContainerParent.offsetHeight -
                bottomPosition)) {

                frameElem.style.bottom = (((window.top.innerHeight) - frambot) / 2) + 5 + "px";
                frameElem.style.position = 'fixed';

                if (env == "mobile") {
                    frameElem.style.left = ((sitewidth - formatWidth) / 2) + "px";

                } else {

                    tofind= parent.document.querySelector("#advertisementContainer")  
                    theposplus = ((tofind.getBoundingClientRect().width) - formatWidth) / 2
                    frameElem.style.left = tofind.getBoundingClientRect().left + theposplus + "px";
                    
                }


            } else {
                frameElem.style.position = 'fixed';
                frameElem.style.bottom = (((window.top.innerHeight) - frambot) / 2) + 5 + "px";

                if (env == "mobile") {
                    frameElem.style.left = ((sitewidth - formatWidth) / 2) + "px";

                } else {
                    tofind= parent.document.querySelector("#advertisementContainer") 
                    theposplus = ((tofind.getBoundingClientRect().width) - formatWidth) / 2;
                    frameElem.style.left = tofind.getBoundingClientRect().left + theposplus + "px";
                 
                     
                

                }


            }
        }
    </script>


</head>

<body>
    <div id="atf-understitial-ad" target="_blank"></div>
    <img src="[%Third_party_impression_tracking_URL_1%]" style="display: none;">
    <img src="[%Third_party_impression_tracking_URL_2%]" style="display: none;">
    <img src="[%Third_party_impression_tracking_URL_3%]" style="display: none;">
    <script>
        jstracking = `[%Third_party_impression_tracking_SCRIPT%]`
        console.log('obj.regex(jstracking)', obj.regex(jstracking));

        if (jstracking) {
            obj.regex(jstracking)

            if (obj.regex(jstracking) == true) {
                thetrackingcodes = document.createElement("script");
                thetrackingcodes.src = jstracking;
                thebodydiv = document.querySelector("#atf-understitial-ad")
                thebodydiv.appendChild(thetrackingcodes)
            } else {
                thetrackingcodes = document.createElement("script");
                thetrackingcodes.type = "text/javascript";
                thetrackingcodes.textContent = jstracking;
                thebodydiv = document.querySelector("#atf-understitial-ad")
                thebodydiv.appendChild(thetrackingcodes)
            }
        }

        jsredirect = `[%JAVASCRIPT_REDIRECT%]`;
        image = "[%IMAGE_HIGH_RESOLUTION%]";




        ad = document.getElementById('atf-understitial-ad');

        if (image) {
            theimg = document.createElement('img');

            theimg.src = image;
            if (env == "desktop") {
                theimg.width = 640;
                theimg.height = 800;
                ad.style.width = 640 + "px"
                ad.style.height = 800 + "px"

            } else if (env == "mobile") {
                theimg.width = 320;
                theimg.height = 460;
                ad.style.width = 320 + "px"
                ad.style.height = 460 + "px"

            }
            theclick = document.createElement("a");
            theclick.setAttribute('href', '%%CLICK_URL_UNESC%%[%Click_through_URL%]');
            theclick.setAttribute("target", "_blank");
            theclick.appendChild(theimg);
            ad.appendChild(theclick)
        }
        if ('[%Click_through_URL%]' !== '') {
            ad.setAttribute('href', '%%CLICK_URL_UNESC%%[%Click_through_URL%]');
        } else {
            ad.addEventListener('click touch', function (event) {
                event.preventDefault();
            });
        }
        if (jsredirect) {
            obj.regex(jsredirect);
            if (obj.regex(jsredirect) == true) {
                thetrackingcodes = document.createElement("script");
                thetrackingcodes.innerHTML = document.write("<scr" + "ipt src=" + jsredirect + " ></scr" + "ipt>");
                thebodydiv = document.querySelector("#atf-understitial-ad");
                thebodydiv.appendChild(thetrackingcodes)
            } else {
                thetrackingcodes = document.createElement("script");
                thetrackingcodes.type = "text/javascript";
                thetrackingcodes.textContent = jsredirect;
                thebodydiv = document.querySelector("#atf-understitial-ad");
                thebodydiv.appendChild(thetrackingcodes)
            }
        }
        frameContainerParent.style.height = frameElem.height + 'px';
        frameContainer.style.height = frameElem.height + 'px';

        if (/rv:11.0/i.test(navigator.userAgent)) {
            frameContainerParent.addEventListener('mouseover', function () {
                frameContainerParent.style.cursor = 'pointer';
            });
            frameContainerParent.addEventListener('click', function () {
                var frameLinks = document.querySelectorAll('[target="_blank"]');
                for (var link = 0; link < frameLinks.length; link++) {
                    if (frameLinks[link].href !== '') {
                        parentWin.open(frameLinks[link].href, '_blank');
                        return false;
                    }
                }
            });
        }
    </script>
</body>

</html>