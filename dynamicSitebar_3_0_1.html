<html>

<head>
    <script>
        var contenttyp = window.parent.atf.getContentType();
        var basehosttry = window.location.hostname.split(".")[0];
        if (basehosttry == "www") {
            basehost = window.location.hostname.split(".")[1]
        } else {
            basehost = window.location.hostname.split(".")[0]
        }
        var creativeType = "dynamicSitebar";
        if (basehost.includes("-")) {
            basehost2 = basehost.split("-")
            basehost3 = basehost2.join("")
            dataToRetrieve = basehost3

        } else {
            dataToRetrieve = basehost
        }
        if (basehosttry == "focus-arztsuche" || basehosttry == "mylife") {
            var theobjecttofind = "creativeSettings" + dataToRetrieve;
            var obj = window.parent[theobjecttofind];
        } else {
            var obj = window.parent.creativeSettings;
        }



        var creativetypte = creativeType;

        function GetPropertyValue(
            object,
            dataToRetrieve,
            contenttyp,
            creativetypte
        ) {
            return obj[dataToRetrieve][contenttyp][creativetypte];
        }
        sitebarobj = GetPropertyValue(
            obj,
            dataToRetrieve,
            contenttyp,
            creativetypte
        );
        console.log('sitebarobj', sitebarobj);
        for (const prop in sitebarobj) {
            singleresult = sitebarobj[prop];
            switch (prop) {
                case "maxheight":
                    maxheight = singleresult;
                    break;
                case "maxheight1":
                    maxheight1 = singleresult;
                    break;
                case "maxheight2":
                    maxheight2 = singleresult;
                    break;
                case "maxheight3":
                    maxheight3 = singleresult;
                    break;
                case "maxheight4":
                    maxheight4 = singleresult;
                    break;
                default:
                    console.log("it is usally not workinglsafnlksajflasjflkaslkfd");
                    break;
            }
        }
        var resizing = function dsaBox() {
            theexactheight = window.parent.innerHeight;
            boxright = frameElement.parentElement.firstChild;
            boxright.style.position = "absolut";
            if (theexactheight >= 1350) {
                boxright.style.maxHeight = maxheight + "px";
            } else if (theexactheight >= 1200 && theexactheight <= 1350) {
                boxright.style.maxHeight = maxheight1 + "px";
            } else if (theexactheight >= 900 && theexactheight <= 1200) {
                boxright.style.maxHeight = maxheight2 + "px";
            } else if (theexactheight >= 700 && theexactheight <= 900) {
                boxright.style.maxHeight = maxheight3 + "px";
            } else {}
            boxright.style.minHeight = 600 + "px";
            boxright.style.maxWidth = 800 + "px";
            boxright.style.minWidth = 300 + "px";
            if (basehost == "gofeminin" || basehost == "instyle" || basehost == "elle" || basehost == "freundin" || basehost == "harpersbazaar" || basehost == "esquire") {
                current_window = window;
                var bh = parent.window.innerHeight - 155;
                var bw = parent.window.innerWidth;
                current_window = current_window.parent;
                current_element = window.frameElement;
                current_element = current_element.offsetParent;
                var viewportOffset = current_element.getBoundingClientRect();
                var left = viewportOffset.left;
                var sitebar_width = bw - left;
                window.frameElement.height = bh;
                window.frameElement.width = sitebar_width;
                boxwidth = window.frameElement.width = sitebar_width + "px";
                boxheight = window.frameElement.height = bh + "px";
            } else {
                var posinBrowser = boxright.getBoundingClientRect();
                var left = posinBrowser.left;
                var topto = top.parent.innerWidth;
                var newbreite = topto - left + - +8;
                boxwidth = boxright.style.width = newbreite + "px";
                toptobor = posinBrowser.top;
                var eh = window.parent.innerHeight;
                var therealhight = eh - toptobor;
                boxheight = boxright.style.height = therealhight + "px";
            }
            return {
                boxheight,
                boxwidth
            };
        };
        delay = 5; // delay between calls
        throttled = false; // are we currently throttled?
        parent.document.getElementsByTagName('body')[0].onscroll = function() {
            if (!throttled) {
                let {
                    boxheight,
                    boxwidth
                } = new resizing();
                throttled = true;
                setTimeout(function() {
                    throttled = false;
                }, delay);
            }
        }
        window.parent.addEventListener("resize", function() {
            if (!throttled) {
                let {
                    boxheight,
                    boxwidth
                } = new resizing();
                throttled = true;
                setTimeout(function() {
                    throttled = false;
                }, delay);
            }
        });
        resizing();
    </script>
</head>

<body>
    <div id="thecreativecont"></div>
</body>
<script>
    celtratag = `[%CELTRATAG%]`
    iframeurl = "[%IFRAME_REDIRECT%]";
    jsredirect = `[%JAVASCRIPT_REDIRECT%]`;
    obj.regex(jsredirect)
        //JSREDIRECT
    if (obj.regex(jsredirect) == true) {
        thecrativecodes = document.createElement("script");
        thecrativecodes.innerHTML = `document.write("<scr" + "ipt src='` + jsredirect + `'></scr" + "ipt>");`;
    } else {
        thecrativecodes = document.createElement("script");
        thecrativecodes.type = "text/javascript";
        thecrativecodes.textContent = jsredirect;
    }
    if (jsredirect != "") {
        console.log("jsredirectcase")
            // document.getElementsByTagName("html")[0].style.height = 100 + "%";
            //document.getElementsByTagName("body")[0].style.height = 100 + "%";
        function theDSA() {
            theDiv = document.getElementById("thecreativecont");
            theDiv.style.maxHeight = 100 + "%";
            theDiv.style.height = 100 + "%";
            theDiv.style.width = 100 + "%";
            dsa = obj.iframecreator(100 + "%", 100 + "%", "about:blank", "theframe");
            theDiv.appendChild(dsa);
            var frameObj = document.getElementById("theframe");
            var frameContent = frameObj.contentWindow.document.body.innerHTML;
            hopethe = frameObj.contentWindow.document.getElementsByTagName(
                "body"
            )[0];
            hopethe.appendChild(thecrativecodes);
        }
        theDSA();
    }
    if (celtratag != "") {
        console.log("celtraTagCase")
        document.getElementsByTagName("html")[0].style.height = 100 + "%";
        document.getElementsByTagName("body")[0].style.height = 100 + "%";

        function theDSA() {
            theDiv = document.getElementById("thecreativecont");
            theDiv.style.maxHeight = 100 + "%";
            theDiv.style.height = 100 + "%";
            theDiv.style.width = 100 + "%";
            dsa = obj.iframecreator(100 + "%", 100 + "%", "about:blank", "theframe");
            theDiv.appendChild(dsa);
            var frameObj = document.getElementById("theframe").contentWindow.document;
            frameObj.open();
            frameObj.write(celtratag);
            frameObj.close();
        }
        theDSA();
    }
    if (iframeurl != "") {
        console.log("IframeCase")
        document.getElementsByTagName("html")[0].style.height = 100 + "%";
        document.getElementsByTagName("body")[0].style.height = 100 + "%";

        function theDSA() {
            var theDiv = document.getElementById("thecreativecont");
            theDiv.style.maxHeight = 100 + "%";
            theDiv.style.height = 100 + "%";
            theDiv.style.width = 100 + "%";
            let dsa = obj.iframecreator(100 + "%", 100 + "%", iframeurl, "theframe");
            theDiv.appendChild(dsa);
        }
        theDSA();
    }
</script>

</html>